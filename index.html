<!doctype html>
<html lang="en">
	<head>

<!--[if IE]>
<script type="text/javascript">
    document.location.href = "./sorryIE.html";
 </script>
<![endif]-->
<script type="text/javascript">
var IS_PHONE = false;
if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) 
{
	IS_PHONE = true;
 	// document.location.href = "./sorry.html";
}
</script>

		<title>Baptiste Bohelay - developer & designer</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	    <meta name="description" content="An experimental website introducing my projects and my work.">
    	<meta name="author" content="Baptiste Bohelay">
		<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
		<link href="css/main.css" rel="stylesheet">

		<!-- the core stuff -->
		<script type="text/javascript" src="script/soundmanager2.js"></script>

		<script type="text/javascript">

		soundManager.setup({
		  flashVersion: 9,
		  preferFlash: true, // for visualization effects
		  useHighPerformance: true, // keep flash on screen, boost performance
		  wmode: 'transparent', // transparent SWF, if possible
		  url: 'soundmanager/swf/'
		});

		soundManager.useFlashBlock = true;
		sSoundManagerReady = false;

  		// even if HTML5 supports MP3, prefer flash so the visualization features can be used.
	  	soundManager.preferFlash = true;

	  	var sAutomatedFadeIn = false;
		</script>

	</head>
	<body>

		<div id="info"> 	
		<CENTER>
		<H2> <strong><br><br><br>loading...</strong><P>
		</div>
		<div id="roundCorner"> </div>
		<div id="backButtonsContainer"> </div>

		<a href="https://github.com/AphexHenry/BaptisteBohelayWebsite"><img title="Look at the GitHub project" id="githubButton" src="textures/icons/githubCircle.png" ></a>

		<a href="https://github.com/AphexHenry/BaptisteBohelayWebsite"><img title="contact me" id="contactButton" src="textures/icons/contactCircle.png" ></a>
 
		<div id="sm2-container" style="z-index:-300;">
		 <!-- flash movie is added here -->
		</div>

		<script src='js/jquery.js'></script>
		<script src='js/jquery.ba-hashchange.min.js'></script>
		<script src="js/bootstrap.min.js"></script>
		<script src='Tools/Tools.js'></script>
		<script src="build/Three.js"></script>
		<script src="fonts/helvetiker_regular.typeface.js"></script>

		<script src='Tools/ButtonsBack.js'></script>
		<script src='Tools/ParticleSocial.js'></script>
		<script src='Tools/Navigation.js'></script>
		<script src='Tools/Organigram.js'></script>
		<script src='Tools/Template.js'></script>
		<script src='Tools/Camera.js'></script>
		<script src='Tools/ParticleCircleNavigate.js'></script>
		<script src='Tools/Monsters/MonsterRandom.js'></script>
		<script src='Tools/Monsters/MonsterTournicoti.js'></script>
		<script src='Tools/Monsters/MonsterNoise.js'></script>
		<script src='Tools/Monsters/MonsterVideo.js'></script>
		<script src='Tools/ParticleGroup/Particle.js'></script>
		<script src='Tools/ParticleGroup/ParticleAboutMe.js'></script>
		<script src='Tools/ParticleGroup/ParticleLulu.js'></script>
		<script src='Tools/ParticleGroup/ParticleVideos.js'></script>
		<script src='Tools/ParticleGroup/ParticleSound.js'></script>
		<script src='Tools/InfoDisplay.js'></script>
		<script src='Tools/intro/EvolutionManager.js'></script>
		<script src='Tools/intro/Monster.js'></script>
		<script src='Tools/intro/ParticleGroupMonster.js'></script>
		<script src='Tools/intro/ParticleLetter.js'></script>

		<script src='Tools/soundPlayer/MonsterSound.js'></script>
		<script src='Tools/soundPlayer/ParticleGroupMonsterSound.js'></script>
		<script src='Tools/soundPlayer/ParticleSound.js'></script>
		<script src='Tools/THREEx.WindowResize.js'></script>
		
		<script>

			var container; 							// WebGL canvas container.
			var camera, scene, projector, renderer; // three.js components.
			var sceneInfo; 							// scene to display static informations.
			var cameraManager;						// camera manager.
			var controlAuto = true; 				//define if the camera has an automatic control (rotation around a point) or a specific one. 

			var mousePosition = new THREE.Vector3(); // position of the mouse.
			var cameraTarget = new THREE.Vector3();	// where the camera needs to go in the end.
			var cameraTargetCurrent = new THREE.Vector3();	// where the camera needs to go next frame.
			var cameraPosition = new THREE.Vector3(); // where the camera is.
			var canInteract = true;						// if false, the user can't interact with the website (like for animations states).		
			var SELECTED = null;					// current bubble selected.
			var Organigram = new Organigram();		// tree of relations between "pages" or actually group of bubbles.
			var isRoot = false;						// if true, we actually are at the home "page".
			var sPageLoaded = false;				// if false, we are waiting for more assets to be loaded.
			var sMinLoading = 1.;					
			var sGeneralTimer = 0;					// timer of the whole app.

			var sProjectsToRandom = [];				// container for projects, used to get a random one.
			var sRandomLastIndex = [];				// list of projects picked randomly to avoid to get one 2 times.
			var sProjectsLast;						// last project added.

			var infoDisplay;						// common text display in 3d.

			var clock = new THREE.Clock();			// clock

			var PI2 = -Math.PI * 1.99;					// PI2

			var mouse = { x: 0, y: 0 }, INTERSECTED;
			var sCoeffCameraMove = 0;

			init();
			animate();

			function init() {

				sWIDTH = window.innerWidth * 0.1;

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 12000 );
				// camera.position.set( 0, 0, 500 );

				scene = new THREE.Scene();
				sceneInfo = new THREE.Scene();

				scene.add( camera );
				sceneInfo.add( camera );

				// init the back button.
				new ButtonsBack();

				 // Monster
				 ParticleGroups[ParticleGroup.PART_INTRO] = new ParticleGroupMonster(new THREE.Vector3(-500, -1000, -1000), "");

				// creations type
				var flyer = [];
				flyer.push({name: "web exploration", target:ParticleGroup.PART_WEB});
				flyer.push({name: "projects", target:ParticleGroup.PART_OTHER});
				// flyer.push({name: "videos", target:ParticleGroup.PART_VIDEOS});
				
				var lFunky = new ParticleGroupIntro(new THREE.Vector3(-2000, 2000, 3000), flyer, "funkyCreation", ParticleGroup.PART_FUNKY_CREATION);
				var monsterNoise = new MonsterNoise(new THREE.Vector3(-1900, 2100, 3100), window.innerWidth * 0.06, {name: "sound monsters", target:ParticleGroup.PART_SOUND_MONSTER});
				var monsterVideo = new MonsterVideo(new THREE.Vector3(-2100, 1900, 3100), window.innerWidth * 0.06, {name: "videos", target:ParticleGroup.PART_VIDEOS});
				lFunky.AddParticle(monsterNoise);
				lFunky.AddParticle(monsterVideo);

				var flyer = [];
				flyer.push({name: "musical baguette", targetURL:"musicalBaguetteHowTo.html", size:0.8});
				flyer.push({name: "Lulu - Iphone Game", target:ParticleGroup.
					PART_LULU});
				flyer.push({name: "musical box", targetHTML:"html/other/MusicalBox.html"});
				sProjectsLast = {name: "last project", targetHTML:"html/other/MusicalBox.html"};
				new ParticleGroupIntro(new THREE.Vector3(0, 2000, 2000), flyer, "projects", ParticleGroup.PART_OTHER);

				// Main choice
				var flyer = [];
				flyer.push({name: "contact", targetHTML:"html/contact.html", size:0.5, addRandom:false});
				flyer.push({name: "about me", target:ParticleGroup.PART_ABOUT_ME});

				var lMenu = new ParticleGroupIntro(new THREE.Vector3(1000, 2000, 2000), flyer, "home", ParticleGroup.PART_CREA_LULU);
				var randomMonster = new MonsterRandom(new THREE.Vector3(1150, 2000, 2000), window.innerWidth * 0.06);
				var randomLastProject = new MonsterTournicoti(new THREE.Vector3(850, 1850, 2000), window.innerWidth * 0.06, sProjectsLast, 1);
				var funkyCreation = new MonsterTournicoti(lMenu.positionCenter, window.innerWidth * 0.1, {name: "creations", target:ParticleGroup.PART_FUNKY_CREATION, size:1.5}, -1);
				lMenu.AddParticle(funkyCreation);
				lMenu.AddParticle(randomMonster);
				lMenu.AddParticle(randomLastProject);

				// sound monsters
				ParticleGroups[ParticleGroup.PART_SOUND_MONSTER] = new ParticleGroupMonsterSound(new THREE.Vector3(2500, 2500, 3500), "SoundMonsters");

				ParticleGroups[ParticleGroup.PART_ABOUT_ME] = new ParticleGroupAboutMe(new THREE.Vector3(2500, -1000, -1500), "AboutMe");

				// Web
				 ParticleGroups[ParticleGroup.PART_WEB] = new ParticleGroupWebExperiment(new THREE.Vector3(-500, -2000, 1000), "WebExperiment");

				 // Lulu
				 ParticleGroups[ParticleGroup.PART_LULU] = new ParticleGroupLulu(new THREE.Vector3(-500, 1000, -1000), "lulu");

				 // Lulu
				 ParticleGroups[ParticleGroup.PART_VIDEOS] = new ParticleGroupVideos(new THREE.Vector3(1000, 1000, -1000), "videos");

				 // add the sounds as they are not in html in the website.
				sProjectsToRandom.push({name: "sound monsters", targetHTML:"html/SoundMonsters.html", size:1.});

				 var lGroupToGo = ParticleGroup.PART_INTRO;
				 var lHTMLToGo = window.location.hash.split('+');
				 for(var i in ParticleGroups)
				 {
				 	if(lHTMLToGo[0] == "#" + ParticleGroups[i].name)
				 	{
				 		lGroupToGo = i;
				 		if(lHTMLToGo.length > 1)
				 		{
				 			CirclesToHtmlEncoded(lHTMLToGo[1]);
				 		}
				 		break;
				 	}
				 }
				 if(!sIsInHTML)
				 {
					FadeIn();
				 }
				 if(sGroupCurrent != ParticleGroup.PART_INTRO)
				 {
				 	ParticleGroups[ParticleGroup.PART_INTRO].Terminate();
				 }

				cameraManager = new CameraManager(camera);
				camera.position = ParticleGroups[lGroupToGo].positionCenter.clone();
				cameraTargetCurrent = camera.position.clone();
				cameraTarget = cameraTargetCurrent.clone();
				cameraPosition = cameraTarget.clone();
				cameraPosition.z += 300;
				cameraManager.SetPositionPixel(cameraPosition);
				cameraManager.LookAt(cameraTarget);
				GoToIndex(lGroupToGo);

				projector = new THREE.Projector();

				renderer = new THREE.CanvasRenderer();
				renderer.setClearColorHex(0xf0f0f0)
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.autoclear = false;

				container.appendChild( renderer.domElement );

				var ImageFront = document.createElement('canvas');
				document.body.appendChild(ImageFront);
				ImageFront.style.position = 'absolute';
				ImageFront.style.left="0px";
				ImageFront.style.top="0px";

            	if(IS_PHONE)
            	{
            		document.addEventListener("touchstart", onDocumentTouchStart, false);
            		document.addEventListener("touchend", onDocumentTouchEnd, false);
            		document.addEventListener("touchmove", onDocumentTouchMove, false);
            	}
            	else
            	{
       		        document.addEventListener( 'mousemove', onDocumentMouseMove, false );
            		document.addEventListener( 'mousedown', onDocumentMouseDown, false );
            		document.addEventListener( 'mouseup', onDocumentMouseUp, false );
            	}

				infoDisplay = new InfoDisplay(1., 1.5);

				THREEx.WindowResize(renderer, cameraManager.GetCamera());
			}

			window.onload = function ()
			{
				sPageLoaded = true;
			}

			window.onhashchange = function () 
			{
				if(!sIsInHTML)
				{
        		 for(var i in ParticleGroups)
				 {
				 	if(GetHashGroup() == ParticleGroups[i].name)
				 	{
				 		GoToIndex(i);
				 		return;
				 	}
				 }
				}
				else
				{
					SetHashGroup(ParticleGroups[sGroupCurrent].name);
					HtmlToCircles();
				}
            }

			function onDocumentMouseUp(event)
			{
				if(canInteract)
				{
					ParticleGroups[sGroupCurrent].MouseUp(event);
				}
			}

			function onDocumentMouseMove( event ) {

				event.preventDefault();

				mousePosition = new THREE.Vector2(event.clientX, event.clientY, 1000);

				mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
			}

			function onDocumentMouseDown( event ) 
			{
				event.preventDefault();
				if(canInteract)
				{
					ParticleGroups[sGroupCurrent].MouseDown(event);
				}
			}

			function onDocumentTouchMove(event)
			{
				event.preventDefault();

				mousePosition = new THREE.Vector2(event.touches[0].clientX, event.touches[0].clientY, 1000);

				mouse.x = ( event.touches[0].clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.touches[0].clientY / window.innerHeight ) * 2 + 1;
			}

			function onDocumentTouchStart(event)
			{
				event.preventDefault();
				mousePosition = new THREE.Vector2(event.touches[0].clientX, event.touches[0].clientY, 1000);

				mouse.x = ( event.touches[0].clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.touches[0].clientY / window.innerHeight ) * 2 + 1;
				
				ParticleGroups[sGroupCurrent].Update(0);

				if(canInteract)
				{
					ParticleGroups[sGroupCurrent].MouseDown(event);
				}
			}

			function onDocumentTouchEnd(event)
			{
				if(canInteract)
				{
					ParticleGroups[sGroupCurrent].MouseUp(event);
				}
			}

			function animate() {

				requestAnimationFrame( animate );

				render();
			}

			function render() {

				if(!sPageLoaded || sMinLoading > -1)
				{
					sMinLoading -= 0.02;
					if(sMinLoading <= 0)
					{
						sMinLoading = -2;
						if(!sIsInHTML)
							HtmlToCircles(200);
					}
					return;
				}

				var radius = ParticleGroups[sGroupCurrent].cameraDistance;
				var delta = Math.max(Math.min(clock.getDelta(), 0.06), 0.001);
				sGeneralTimer+=delta;
				infoDisplay.Update(delta);

				cameraManager.Update(delta);
				sButtonsBack.Update(delta);

				if(!SELECTED && controlAuto)
				{
					cameraTarget = ParticleGroups[sGroupCurrent].positionCenter;
					cameraPosition.x = ParticleGroups[sGroupCurrent].positionCenter.x + radius * Math.sin( sGeneralTimer * Math.PI / 40 );
					cameraPosition.y = ParticleGroups[sGroupCurrent].positionCenter.y + radius * Math.sin( sGeneralTimer * Math.PI / 40 );
					cameraPosition.z = ParticleGroups[sGroupCurrent].positionCenter.z + radius * Math.cos( sGeneralTimer * Math.PI / 40 );
				}
				if(isNaN(camera.position.x))
				{
					camera.position = new THREE.Vector3();
					console.log("error, NAN");
				}

				cameraManager.UpdateGoTo(cameraPosition, cameraTarget);

				camera.updateMatrixWorld();
				if(canInteract)
				{
					ParticleGroups[sGroupCurrent].Update(delta);
				}

				// rotate camera
				renderer.clear(true, true, true);

				renderer.render( sceneInfo, camera );
				renderer.render( scene, camera );

			}

		</script>
		
		<!-- Piwik -->
		<script type="text/javascript">
		  // var _paq = _paq || [];
		  // _paq.push(["trackPageView"]);
		  // _paq.push(["enableLinkTracking"]);

		  // (function() {
		  //   var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.moumne.com/";
		  //   _paq.push(["setTrackerUrl", u+"piwik.php"]);
		  //   _paq.push(["setSiteId", "9"]);
		  //   var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
		  //   g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
		  // })();
		</script>
		<!-- End Piwik Code -->

	</body>
</html>
